blueprint:
  name: Rolladen auf
  description: Öffnet morgens einen Rolladen
  source_url: https://github.com/akrauss/HAblue/edit/main/Rolladen_auf.yaml
  domain: automation
  input:
    device_rolladen:
      name: Rolladen
      description: Dieser Rolladen wird geöffnet
      selector:
          entity:
            domain: cover
    zeitplan_rolladen_arbeitstag:
      name: Zeitplan
      description: Zeitplan des Rolladens für Arbeitstage
      selector:
        text:
    zeitplan_rolladen:
      name: Zeitplan
      description: Zeitplan des Rolladens für andere Tage
      selector:
        text:
    helligkeit:
      name: Mindest Helligkeit
      description: Dieser Wert muss überschritten werden um den Rolladen zu öffnen
      default: 40
      selector:
        number:
          min: 0
          max: 200
trigger:
  - platform: numeric_state
    entity_id: sensor.koe11_helligkeit_30min_ha
    for:
      hours: 0
      minutes: 15
      seconds: 0
    above: !input helligkeit
  - platform: state
    entity_id:
      - !input zeitplan_rolladen
    from: "on"
    to: "off"
condition:
  - condition: and
    conditions:
      - condition: numeric_state
        entity_id: sensor.koe11_helligkeit_30min_ha
        above: !input helligkeit
      - condition: state
        entity_id: !input zeitplan_rolladen
        state: "off"
action:
  - service: cover.open_cover
    entity_id: !input device_rolladen
mode: single
